# 个人报告

| 学号     | 姓名   | 日期      |
| -------- | ------ | --------- |
| 16340311 | 周远笛 | 2019.6.14 |

### 树的生长

使用Lsystem定义语法：其中[]代表着一根树枝的开始和结束，a代表树枝变细，b代表树枝变粗，x代表可以继续迭代产生新树枝的地方等等。因此每次迭代都有一定概率令X产生新的枝叶。迭代次数不同，树的大小就会不同。

每个树枝都是计算圆柱体的顶点，由上下两个圆形的顶点组合成三角面片并加以贴图构成。树枝的方向是通过旋转变换实现的。

因此整个树的渲染，是先根据文法，计算出每个枝条的起点终点位置坐标，在其间绘制圆柱体。根据起点、终点坐标计算圆柱体的旋转角和旋转轴，并进行model的变换。

叶子的实现方式更为简单，不需要圆柱体的绘制，只需要将叶片贴图到正方形上即可。这里需要注意叶子的贴图需要载入透明度，得到叶片的抠图效果。

### 天空盒

天空盒相当于一个立方体贴图，只不过只保留了摄像机view矩阵的九个自由度，实现了天空盒不随摄像机的移动而变化。

立方体贴图的原理是一个texture数组，根据每个texture在shader的下标，进行绑定和激活。在渲染时呈现。

### 地形模拟

这里的地形是根据一副平面的地形贴图得到的，根据灰度贴图的r通道数值决定地形的高低。为了使得地形实现得更加逼真，在不同的高度采用不同的贴图，比如最底下是沙地（sand），虽然在渲染的时候被水遮挡了；向上是草地和沙地的结合；之后是草地和石头的结合。并且根据坡度的变化调节二者再结合过程中的占比。